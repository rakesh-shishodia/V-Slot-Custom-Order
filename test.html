<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ecwid Product Fetch Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .product-selector { display: flex; gap: 20px; margin-bottom: 30px; }
    .product-box {
      cursor: pointer;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 12px;
      width: 200px;
      text-align: center;
      transition: box-shadow 0.2s, border-color 0.2s;
    }
    .product-box:hover { border-color: #006064; box-shadow: 0 4px 8px rgba(0,96,100,0.1); }
    .product-box.selected {
      background-color: #E0F7FA;
      border-color: #006064;
      color: #006064;
    }
    .product-name { font-size: 18px; margin-bottom: 8px; }
    .price-pill {
      display: inline-block;
      background-color: #e0f7fa;
      color: #006064;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 14px;
    }
    .details-panel { max-width: 600px; }
    .image-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 20px;
    }
    .image-cell img {
      width: 100%;
      height: auto;
      display: block;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .description { border-top: 1px solid #ddd; padding-top: 20px; }
  </style>
</head>
<body>

  <h1>Ecwid Fetch Test</h1>
  <div class="product-selector" id="productSelector">
    <!-- boxes go here -->
  </div>

  <div class="details-panel" id="detailsPanel" style="display:none;">
    <div class="image-grid" id="imageGrid">
      <div class="image-cell"><img id="img0" src="" alt=""></div>
      <div class="image-cell"><img id="img1" src="" alt=""></div>
      <div class="image-cell"><img id="img2" src="" alt=""></div>
      <div class="image-cell"><img id="img3" src="" alt=""></div>
    </div>
    <div class="description" id="description"></div>
    <div class="attributes" id="attributes"></div>
  </div>
<script src="ecwid-data.js"></script>
<script>
  // fetch and render products on page load
  EcwidData.fetchAll()
    .then(items => {
      const selector = document.getElementById('productSelector');
      items.forEach(item => {
        const box = document.createElement('div');
        box.className = 'product-box';
        box.dataset.id = item.id;
        const pricePerM = Math.round(item.baseCostPerMm * 1000);
        box.innerHTML = `
          <div class="product-name">${item.name}</div>
          <div class="price-pill">â‚¹${pricePerM}/m</div>
        `;
        selector.appendChild(box);
        box.addEventListener('click', () => {
          document.querySelectorAll('.product-box').forEach(b => b.classList.remove('selected'));
          box.classList.add('selected');
          showDetails(item);
        });
      });
      // auto-select first product
      const firstBox = selector.querySelector('.product-box');
      if (firstBox) firstBox.click();
    })
    .catch(err => console.error('EcwidData fetchAll error:', err));
  
  function showDetails(item) {
    // images
    const imgs = item.images.slice(0, 4);
    for (let i = 0; i < 4; i++) {
      document.getElementById('img' + i).src = imgs[i] || '';
    }
    // description
    document.getElementById('description').innerHTML = item.descriptionHtml;
    // attributes display
    const attrDiv = document.getElementById('attributes');
    attrDiv.innerHTML = `
      <p><strong>Type:</strong> ${item.attributes.type}</p>
      <p><strong>Series:</strong> ${item.attributes.series}</p>
      <p><strong>Color:</strong> ${item.attributes.color}</p>
      <p><strong>Holes per side:</strong> ${item.holesPerSide}</p>
    `;
    // show panel
    document.getElementById('detailsPanel').style.display = 'block';
  }
</script>

</body>
</html>